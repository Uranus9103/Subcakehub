local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- GUI
local gui = player:WaitForChild("PlayerGui"):FindFirstChild("LiftGui")
if not gui then
	gui = Instance.new("ScreenGui")
	gui.Name = "LiftGui"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")
end

-- Khung menu
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0,220,0,180)
frame.Position = UDim2.new(0.05,0,0.2,0)
frame.BackgroundColor3 = Color3.fromRGB(0,0,0)
frame.Active = true
frame.Draggable = true
frame.Parent = gui

-- Vi·ªÅn c·∫ßu v·ªìng
local UIStroke = Instance.new("UIStroke")
UIStroke.Thickness = 3
UIStroke.Parent = frame

task.spawn(function()
	while true do
		for hue=0,1,0.01 do
			UIStroke.Color = Color3.fromHSV(hue,1,1)
			task.wait(0.05)
		end
	end
end)

local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0,12)
frameCorner.Parent = frame

-- Button t·∫°o
local function createButton(name, posY, color)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.9,0,0,40)
	btn.Position = UDim2.new(0.05,0,posY,0)
	btn.Text = name
	btn.TextScaled = true
	btn.BackgroundColor3 = color
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.Font = Enum.Font.GothamBold
	btn.Parent = frame
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0,10)
	corner.Parent = btn
	return btn
end

local btnFly = createButton("üõë ƒêi Tr√™n Kh√¥ng",0.2,Color3.fromRGB(50,200,50))
local btnLift = createButton("‚¨ÜÔ∏è N√¢ng",0.5,Color3.fromRGB(50,100,200))

-- Bi·∫øn ƒëi tr√™n kh√¥ng
local flyPart = nil
local flyEnabled = false
local flyConnection = nil
local flyHeight = 3
local goingUp = true
local switchTime = 1
local flyTimer = 0
local flyRange = 1

-- Th√¥ng b√°o ƒë·∫πp
local function showNotice(text)
	local notice = Instance.new("TextLabel")
	notice.Size = UDim2.new(0.4,0,0.08,0)
	notice.Position = UDim2.new(0.3,0,0.05,0)
	notice.BackgroundTransparency = 0.2
	notice.BackgroundColor3 = Color3.fromRGB(30,30,30)
	notice.Text = text
	notice.TextScaled = true
	notice.Font = Enum.Font.GothamBold
	notice.TextColor3 = Color3.fromRGB(255,255,255)
	notice.Parent = gui
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0,10)
	corner.Parent = notice
	local stroke = Instance.new("UIStroke")
	stroke.Thickness = 2
	stroke.Color = Color3.fromRGB(255,255,0)
	stroke.Parent = notice
	game:GetService("Debris"):AddItem(notice,6)
end

-- ƒêi Tr√™n Kh√¥ng t·ª± ƒë·ªông ON/OFF
local function startFlyLoop()
	if flyEnabled then return end
	flyEnabled = true
	btnFly.BackgroundColor3 = Color3.fromRGB(50,200,50)

	task.spawn(function()
		while flyEnabled do
			local character = player.Character or player.CharacterAdded:Wait()
			local hrp = character:WaitForChild("HumanoidRootPart")

			flyPart = Instance.new("Part")
			flyPart.Size = Vector3.new(8,1,8)
			flyPart.Anchored = true
			flyPart.CanCollide = true
			flyPart.Color = Color3.fromRGB(100,150,250)
			flyPart.Transparency = 0.2
			flyPart.Name = "FlyPlatform"
			flyPart.Parent = workspace
			flyPart.CFrame = CFrame.new(hrp.Position - Vector3.new(0, flyHeight, 0))

			goingUp = true
			flyTimer = 0

			flyConnection = RunService.RenderStepped:Connect(function(dt)
				if hrp and flyPart then
					flyTimer = flyTimer + dt
					if flyTimer >= switchTime then
						goingUp = not goingUp
						flyTimer = 0
					end

					local basePos = hrp.Position - Vector3.new(0, flyHeight, 0)
					local offset = goingUp and flyRange or -flyRange
					flyPart.CFrame = flyPart.CFrame:Lerp(CFrame.new(basePos + Vector3.new(0, offset, 0)), 0.2)
				end
			end)

			task.wait(6)

			if flyConnection then flyConnection:Disconnect() end
			if flyPart then flyPart:Destroy() end
			flyPart = nil
			showNotice("‚ö†Ô∏è Vui l√≤ng t·∫Øt b·∫≠t l·∫°i nhanh ƒë·ªÉ kh√¥ng b·ªã l·ªói ‚ö†Ô∏è")

			task.wait(0.1)
		end
	end)
end

btnFly.MouseButton1Click:Connect(function()
	if flyEnabled then
		flyEnabled = false
		if flyConnection then flyConnection:Disconnect() end
		if flyPart then flyPart:Destroy() end
		btnFly.BackgroundColor3 = Color3.fromRGB(200,50,50)
	else
		startFlyLoop()
	end
end)

-- N√∫t N√¢ng (t·ªëc ƒë·ªô 17, b·∫±ng part n√¢ng)
btnLift.MouseButton1Click:Connect(function()
	local character = player.Character or player.CharacterAdded:Wait()
	local hrp = character:WaitForChild("HumanoidRootPart")

	-- N·∫øu ƒë√£ c√≥ platform th√¨ x√†i l·∫°i
	local liftPart = workspace:FindFirstChild("LiftPlatform")
	if not liftPart then
		liftPart = Instance.new("Part")
		liftPart.Size = Vector3.new(8,1,8)
		liftPart.Anchored = true
		liftPart.CanCollide = true
		liftPart.Color = Color3.fromRGB(250,200,100)
		liftPart.Transparency = 0
		liftPart.Name = "LiftPlatform"
		liftPart.Parent = workspace
		liftPart.CFrame = CFrame.new(hrp.Position - Vector3.new(0,3,0))
	end

	btnLift.BackgroundColor3 = Color3.fromRGB(100,200,250)

	-- N√¢ng trong khi gi·ªØ
	local lifting = true
	local connection
	connection = RunService.RenderStepped:Connect(function(dt)
		if lifting and liftPart then
			local pos = liftPart.Position
			liftPart.Position = pos + Vector3.new(0,17*dt,0)
		end
	end)

	-- Nh·∫•n l·∫ßn n·ªØa th√¨ d·ª´ng
	btnLift.MouseButton1Click:Once(function()
		lifting = false
		if connection then connection:Disconnect() end
		btnLift.BackgroundColor3 = Color3.fromRGB(50,100,200)
	end)
end)
